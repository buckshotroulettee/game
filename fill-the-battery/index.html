<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="game.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500&display=swap" rel="stylesheet">
  <title>Fill The Battery</title>
  <style type="text/css">
    .jss1:before {
      top: 0;
      width: 100%;
      filter: blur(16px);
      height: 100%;
      content: "";
      display: block;
      opacity: .5;
      z-index: 0;
      position: absolute;
      background-size: cover;
      background-image: url("background.png")
    }
  </style>
</head>

<body>
<div id="unity-container" class="unity-desktop" style="width:480px; height: 854px"><canvas id="unity-canvas"></canvas></div>
<div id="loadingBlock" style="">
  <div class="jss31 jss34 jss1">
    <div class="spinner"></div>
    <div class="jss31 jss34 jss48" style="flex: 1 1 0%;">
      <div class="jss32">
        <div class="jss7 jss9 jss20 jss3">
          <div class="jss125">
            <div class="jss123">
             <img src="1games.png">
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="jss31 jss34" style="flex: 3 1 0%;">
      <div class="jss32">
        <div class="jss31 jss34 jss39 jss50 gameloader">
          <div class="jss32">
            <div class="gameloader-game-name">Fill The Battery</div>
          </div>
          <div class="jss32">
            <div class="jss32 gameloader-logo">
              <img id="game-logo" src="background.png">
            </div>
          </div>
          <div class="jss32">
            <div>
              <div class="gameloader-progressbar">
                <div class="gameloader-progressbar-progress" id="progress_fill"
                     style=""></div>
              </div>
              <div class="gameloader-progress-info"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</body>

<!-- <script src="Build/UnityLoader.js"></script> -->
<script> 
        var canvas = document.querySelector("#unity-canvas");
        var loadingBar = document.querySelector("#unity-loading-bar");
        var progressBarFull = document.querySelector("#unity-progress-bar-full");

        var iframe_game = document.getElementsByClassName("unity-desktop");
        var start_w = parseInt(iframe_game[0].style.width);
        var start_h = parseInt(iframe_game[0].style.height);
        var frame_aspect_ratio = start_w / start_h;
        var frame_aspect_ratio_h = start_h / start_w;

        reportWindowSize();

        function reportWindowSize() {
            var inner_w = parseInt(window.innerWidth);
            var inner_h = parseInt(window.innerHeight);
            var curent_aspect_ratio = inner_w / inner_h;
            if (frame_aspect_ratio <= curent_aspect_ratio) {
                iframe_game[0].style.height = inner_h + "px";
                iframe_game[0].style.width = (inner_h * frame_aspect_ratio) + "px";
                iframe_game[0].style.marginLeft = (inner_w - (inner_h * frame_aspect_ratio)) / 2 + "px";
                iframe_game[0].style.marginTop = "0px";
                //console.log("Inner W " + inner_w + " " + "Inner H " + inner_h);
            } else {
                iframe_game[0].style.width = inner_w + "px";
                iframe_game[0].style.height = (inner_w * frame_aspect_ratio_h) + "px";
                iframe_game[0].style.marginTop = (inner_h - (inner_w * frame_aspect_ratio_h)) / 2 + "px";
                iframe_game[0].style.marginLeft = "0px";
                //console.log("Inner W " + inner_w + " " + "Inner H " + inner_h);
                console.log(frame_aspect_ratio_h);
            }


        }

        window.onresize = reportWindowSize;
  var progressElement = document.getElementById('progress_fill'); 

var buildUrl = "Build";
      var loaderUrl = buildUrl + "/Fill The Battery - GD.loader.js";
      var config = {
        dataUrl: buildUrl + "/Fill The Battery - GD.data",
        frameworkUrl: buildUrl + "/Fill The Battery - GD.framework.js",
        codeUrl: buildUrl + "/Fill The Battery - GD.wasm",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "",
        productName: "rolling ball 3d",
        productVersion: "1",
      };
 const loader = document.querySelector("#loadingBlock");
    const container_append = document.querySelector("#unity-container");
    const progress_text = document.querySelector(".gameloader-progress-info");
    let text_percent = "";
    let percent_progress = "";
	var canvas = document.querySelector("#unity-canvas");
	  const progress = document.querySelector("#loadingBlock .gameloader-progressbar-progress");
	  progress.style.display = "block";
      loader.querySelector(".spinner").style.display = "none";
	  
		var script = document.createElement("script");
		  script.src = loaderUrl;
		  script.onload = () => {
			createUnityInstance(canvas, config, (progress) => {
					percent_progress = progress * 100
				progressElement.style.width = `${percent_progress}%`; 
				text_percent = "Loading file: " + Math.round(percent_progress) + "%";
				progress_text.innerText = text_percent;
			
				if (percent_progress >= 99) {
				  progress_text.innerText = "Loading ...";
				}
				 
			}).then((unityInstance) => {
			 loader.style.display = "none";
			 container_append.style.display = "block";
			   
			}).catch((message) => {
			  alert(message);
			});
      };
      document.body.appendChild(script);
</script>

</html>
